<ion-content [fullscreen]="true" class="page-bg producer-orders-content">
  <div class="page-shell product-shell producer-orders-shell">
    <!-- Título de la página -->
    <h1 class="page-title">Pedidos</h1>
    
    <!-- Page Header -->
  <div class="page-header">
    <!-- <div class="title-wrap">
      <ion-badge color="secondary">{{ items.length || 0 }}</ion-badge>
    </div> -->

    <!-- Tabs Section -->
    <div class="tabs-section">
      <div class="filter-tabs">
        <button
          type="button"
          class="tab-btn"
          [class.active]="statusFilter === 'pending'"
          (click)="goFilter('pending')"
          aria-label="Ver pedidos pendientes">
          <ion-icon name="hourglass-outline"></ion-icon>
          Pendientes
          <ion-badge color="warning">{{ pendingCount }}</ion-badge>
        </button>

        <button
          type="button"
          class="tab-btn"
          [class.active]="statusFilter === 'all'"
          (click)="goFilter('all')"
          aria-label="Ver todos los pedidos">
          <ion-icon name="list-outline"></ion-icon>
          Todos
          <ion-badge color="primary">{{ allCount }}</ion-badge>
        </button>
      </div>
    </div>
  </div>

  <!-- Loading Skeleton -->
  <div class="skeleton-container" *ngIf="isLoading">
    <ion-card class="skeleton-card" *ngFor="let _ of [1,2,3]">
      <ion-card-header>
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <ion-skeleton-text animated style="width: 60%; height: 16px;"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 80px; height: 20px; border-radius: 999px;"></ion-skeleton-text>
        </div>
      </ion-card-header>
      <ion-card-content>
        <div class="skeleton-row">
          <ion-skeleton-text animated style="width: 30%; height: 12px;"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 40%; height: 12px;"></ion-skeleton-text>
        </div>
        <div class="skeleton-row">
          <ion-skeleton-text animated style="width: 25%; height: 12px;"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 35%; height: 12px;"></ion-skeleton-text>
        </div>
        <div class="skeleton-row">
          <ion-skeleton-text animated style="width: 30%; height: 12px;"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 45%; height: 12px;"></ion-skeleton-text>
        </div>
        <div class="skeleton-row total">
          <ion-skeleton-text animated style="width: 20%; height: 14px;"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 50%; height: 14px;"></ion-skeleton-text>
        </div>
        <ion-skeleton-text animated style="width: 100%; height: 36px; margin-top: 12px; border-radius: 8px;"></ion-skeleton-text>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Orders List -->
  <div class="orders-list" *ngIf="!isLoading && items.length; else emptyTpl">
    <ion-card class="order-card" *ngFor="let o of items">
      <ion-card-content>
        <div class="order-card__body">
          <div class="card-header">
            <div class="order-title">
              <ion-icon name="bag-outline" color="primary"></ion-icon>
              <div class="title-content">
                <div class="order-id">#{{ o.id }}</div>
                <div class="product-name">{{ o.productName }}</div>
              </div>
            </div>
            <ion-chip 
              class="status-chip" 
              [class]="'status-chip ' + statusChipColor(o.status)"
              [color]="getStatusChipColor(o.status)">
              {{ o.status | statusTranslatePipes }}
            </ion-chip>
          </div>

          <div class="order-details">
            <div class="detail-row">
              <div class="detail-label">
                <ion-icon name="calendar-outline" color="medium"></ion-icon>
                <span>Fecha</span>
              </div>
              <div class="detail-value">{{ o.createAt | date : 'mediumDate' : '' : 'es-CO' }}</div>
            </div>
            
            <div class="detail-row">
              <div class="detail-label">
                <ion-icon name="cube-outline" color="medium"></ion-icon>
                <span>Cantidad</span>
              </div>
              <div class="detail-value">{{ o.quantityRequested | number }} unidad(es)</div>
            </div>
            
            <div class="detail-row">
              <div class="detail-label">
                <ion-icon name="calculator-outline" color="medium"></ion-icon>
                <span>Subtotal</span>
              </div>
              <div class="detail-value">{{ asCurrency(o.subtotal) }}</div>
            </div>
            
            <div class="detail-row total-row">
              <div class="detail-label">
                <ion-icon name="cash-outline" color="success"></ion-icon>
                <span>Total</span>
              </div>
              <div class="detail-value total">{{ asCurrency(o.total) }}</div>
            </div>
          </div>

          <app-button
            text="Ver detalle"
            color="primary"
            icon="eye-outline"
            (clicked)="goToOrderDetail(o.code)"
            style="--app-button-margin:16px 0 0"></app-button>
        </div>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Empty State -->
  <ng-template #emptyTpl>
    <div class="empty-state" *ngIf="!isLoading">
      <div class="empty-icon">
        <ion-icon name="inbox-outline" color="medium"></ion-icon>
      </div>
      <h3>No hay pedidos</h3>
      <p>No hay pedidos para mostrar con el filtro seleccionado.</p>
      <div class="empty-actions">
        <ion-button fill="outline" (click)="goFilter('all')" color="primary" size="default">
          <ion-icon slot="start" name="list-outline"></ion-icon>
          Ver todos los pedidos
        </ion-button>
      </div>
    </div>
  </ng-template>
  </div>
</ion-content>
