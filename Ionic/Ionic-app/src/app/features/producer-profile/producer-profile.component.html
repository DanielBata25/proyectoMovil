<ion-header translucent="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home/inicio"></ion-back-button>
    </ion-buttons>
    <ion-title>Perfil del productor</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="profile-content">
  <div class="page-shell">
    <div class="center" *ngIf="loading">
      <ion-spinner name="crescent"></ion-spinner>
      <p class="muted">Cargando información...</p>
    </div>

    <ng-container *ngIf="!loading && producer; else emptyState">
      <section class="profile-card">
        <ion-icon class="avatar" name="person-circle-outline"></ion-icon>
        <h2>{{ producer.fullName }}</h2>
        <div class="rating" *ngIf="producer.averageRating !== null && producer.averageRating !== undefined">
          <ion-icon name="star"></ion-icon>
          <span>{{ producer.averageRating | number: '1.1-1' }}</span>
          <span class="rating-label">/ 5</span>
        </div>
        <p class="description">
          {{ producer.description || 'Este productor aún no ha actualizado su descripción.' }}
        </p>
      </section>

      <section class="info-card">
        <div class="pair">
          <div class="lbl">Código</div>
          <div class="val code">{{ producer.code }}</div>
        </div>
        <div class="pair">
          <div class="lbl">Correo</div>
          <div class="val">{{ producer.email || 'No registrado' }}</div>
        </div>
        <div class="pair">
          <div class="lbl">Teléfono</div>
          <div class="val">{{ producer.phoneNumber || 'No registrado' }}</div>
        </div>
      </section>

      <section class="info-card">
        <h3>Redes sociales</h3>
        <div class="networks" *ngIf="producer.networks?.length; else noNetworks">
          <a
            class="network-chip"
            *ngFor="let network of producer.networks"
            [href]="normalizeUrl(network.url)"
            target="_blank"
            rel="noopener noreferrer">
            <ion-icon [name]="networkIcon(network.network)"></ion-icon>
            <span>{{ networkLabel(network.network) }}</span>
          </a>
        </div>
        <ng-template #noNetworks>
          <p class="muted small">El productor aún no registra redes sociales.</p>
        </ng-template>
      </section>
    </ng-container>

    <ng-template #emptyState>
      <div class="center" *ngIf="errorMessage">
        <p class="error">{{ errorMessage }}</p>
        <ion-button fill="clear" (click)="retry()">Reintentar</ion-button>
      </div>
    </ng-template>
  </div>
</ion-content>
